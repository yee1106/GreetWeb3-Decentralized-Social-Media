"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[509],{49509:function(e,n,t){t.d(n,{Z:function(){return oe}});var r=t(85893),i=t(34051),o=t.n(i),s=t(67294),a=t(3857),u=t(34736),c=t(66137),l=t(95117),d=t(74459),f=t(86462),m=t(57148),h=t(99985),p=t(49834),x=t(47834),v=t(39954),g=t(9094),w=t(20966),y=t(7001),j=t(93719),k=t(75489),b=t(29355),C=t(80471),N=t(5434),S=t(89583),z=t(8193),I=t(66982),A=t.n(I),M=t(30381),P=t.n(M),T=t(83078),E=t(41664),q=t(48444),_=t(74922),Z=t(47516),H=t(54777),L=t(40681),U=t(58067);function G(e,n,t,r,i,o,s){try{var a=e[o](s),u=a.value}catch(c){return void t(c)}a.done?n(u):Promise.resolve(u).then(r,i)}var F=(0,U.k)((function(e){return{comment:{backgroundColor:"dark"===e.colorScheme?e.colors.dark[4]:e.colors.gray[1],borderRadius:e.radius.md,maxWidth:"80%"},commentHeader:{width:"100%"},commentUserName:{color:"dark"===e.colorScheme?e.white:e.black},commentBySelf:{color:e.colors.indigo[3]},profileLink:{cursor:"pointer"}}})),Q=function(e){var n=e.text,t=e.image,i=e.timestamp,u=e.self,f=e.userName,m=e.userId,g=e.commentId,w=e.updateCount,y=e.deleteCommentUpdate,j=(0,a.rZ)(),b=(0,T.Nr)().Moralis,N=(0,s.useState)(!1),S=N[0],z=N[1],I=(0,L.s)(m).result,A=F(),M=A.classes,q=A.cx,H=function(){var e,n=(e=o().mark((function e(){var n,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new b.Query("GreetComment")).equalTo("objectId",g),e.next=4,n.first();case 4:return t=e.sent,console.log(g),e.next=8,null===t||void 0===t?void 0:t.destroy();case 8:(0,_.c0)({title:"Success",message:"Comment deleted",autoClose:2500,disallowClose:!0,color:"green"}),y(g),w();case 11:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function s(e){G(o,r,i,s,a,"next",e)}function a(e){G(o,r,i,s,a,"throw",e)}s(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,r.jsx)(d.x,{my:"md",children:(0,r.jsxs)(c.Z,{position:"left",spacing:"xs",align:"flex-start",my:"xs",children:[(0,r.jsx)(E.default,{href:{pathname:"/profile",query:{id:m}},passHref:!0,children:(0,r.jsx)(h.q,{radius:"lg",color:"dark"===j.colorScheme?"dark":"gray",size:40,src:(null===I||void 0===I?void 0:I.get("profile_pic").url())||"",className:M.profileLink,children:(0,r.jsx)(C.Mdg,{size:"100%"})})}),(0,r.jsxs)(d.x,{className:M.comment,p:"xs",children:[(0,r.jsxs)(c.Z,{position:"apart",spacing:5,className:M.commentHeader,children:[(0,r.jsxs)(c.Z,{spacing:5,children:[(0,r.jsx)(E.default,{href:{pathname:"/profile",query:{id:m}},passHref:!0,children:(0,r.jsx)(l.x,{weight:"bold",size:"sm",className:q(u?M.commentBySelf:M.commentUserName,M.profileLink),variant:"link",children:f})}),(0,r.jsx)(l.x,{size:"sm",color:"dimmed",children:P()(parseInt(i)).fromNow()})]}),(0,r.jsxs)(k.v,{position:"bottom-start",offset:0,opened:S,onChange:z,children:[(0,r.jsx)(k.v.Target,{children:(0,r.jsx)(p.A,{children:(0,r.jsx)(Z.Q81,{size:"100%"})})}),(0,r.jsxs)(k.v.Dropdown,{children:[(0,r.jsx)(k.v.Label,{children:(0,r.jsx)(l.x,{size:"xs",children:"Comment Action"})}),u&&(0,r.jsx)(k.v.Item,{color:"red",onClick:H,children:"Delete Comment"})]})]})]}),(0,r.jsx)(x.o,{maxHeight:100,hideLabel:"Hide",showLabel:"Show more",styles:{control:{color:j.colors.indigo,fontSize:j.fontSizes.sm}},children:(0,r.jsx)(l.x,{size:"sm",style:{wordBreak:"break-word",whiteSpace:"pre-line"},children:n})}),t&&(0,r.jsx)(v.E,{src:t,alt:""})]})]})})},R=t(26102),B=(0,U.k)((function(e){return{container:{width:"100%"},group:{width:"100%"},input:{width:"80%"}}})),O=function(e){var n=e.onComment,t=e.onCommentChange,i=e.onCommentFileChange,o=e.onPreviewRemove,a=e.preview,u=e.disabled,l=(0,s.useRef)(null),f=B().classes;return(0,r.jsxs)(d.x,{className:f.container,children:[a&&(0,r.jsxs)(d.x,{sx:{width:100,height:100},style:{position:"relative"},ml:"sm",children:[(0,r.jsx)(c.Z,{position:"right",children:(0,r.jsx)(p.A,{color:"red",size:"lg",radius:"xl",variant:"filled",disabled:u,style:{position:"absolute",zIndex:1},onClick:o,children:(0,r.jsx)(z.oHP,{size:"50%"})})}),(0,r.jsx)(v.E,{src:a,alt:"comment",style:{display:"block"},width:100,height:100})]}),(0,r.jsxs)(c.Z,{mt:"sm",position:"center",align:"center",className:f.group,children:[(0,r.jsx)(R.g,{placeholder:"Comment",radius:"md",size:"xs",className:f.input,onChange:t}),(0,r.jsx)(p.A,{onClick:function(){var e;null===(e=l.current)||void 0===e||e.click()},disabled:u,children:(0,r.jsx)(Z.Zw4,{size:"100%"})}),(0,r.jsx)(p.A,{onClick:n,loading:u,children:(0,r.jsx)(Z.PRb,{size:"100%"})}),(0,r.jsx)("input",{type:"file",hidden:!0,ref:l,accept:"image/*",onChange:i})]})]})};var D=t(65338);function K(e,n,t,r,i,o,s){try{var a=e[o](s),u=a.value}catch(c){return void t(c)}a.done?n(u):Promise.resolve(u).then(r,i)}function V(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function s(e){K(o,r,i,s,a,"next",e)}function a(e){K(o,r,i,s,a,"throw",e)}s(void 0)}))}}var $=function(e){return new Promise((function(n,t){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return n(r.result)},r.onerror=function(e){return t(e)}}))},J=function(e){var n=e.onClick;return(0,r.jsx)(u.k,{m:"0",onClick:n,sx:function(e){return{":hover":{textDecoration:"underline"},color:e.colors.indigo}},children:(0,r.jsx)(l.x,{size:"sm",children:"View More"})})},W=function(e){var n=e.id,t=e.count,i=e.updateCount,a=(0,s.useState)(null),u=a[0],c=a[1],l=(0,s.useState)(""),f=l[0],m=l[1],h=(0,s.useState)(""),p=h[0],x=h[1],v=(0,T.Nr)().Moralis,y=function(){var e=(0,T.Nr)(),n=e.user,t=(e.isAuthenticated,e.isInitialized,(0,T.Oc)("NewUser",(function(e){return e.equalTo("userAddress",null===n||void 0===n?void 0:n.get("ethAddress")).limit(1)}),[])),r=t.data,i=t.isLoading,o=t.error;return{currentUser:r[0],isLoading:i,error:o}}(),k=y.currentUser,b=(y.isLoading,(0,T.xc)("GreetComment")),C=b.save,N=b.isSaving,S=(b.error,(0,D.xe)({id:n})),z=S.comment,I=S.count,A=S.fetchMore,M=S.loading,P=(S.hasMore,S.newCommentUpdate),E=S.deleteCommentUpdate,q=(0,s.useRef)(null);(0,s.useEffect)((function(){if(u){var e=function(){var e=V(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(u);case 2:n=e.sent,x(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[u]);var L=function(){var e=V(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=4;break}return(0,_.yK)("comment-error"),(0,_.c0)({title:"Error",id:"comment-error",message:"Empty Comment",autoClose:2e3,disallowClose:!0,color:"red",icon:(0,r.jsx)(Z.Cw1,{size:"100%"})}),e.abrupt("return");case 4:if(!u||!k){e.next=7;break}return e.next=7,C({content:f,greet_id:n,comment_by_user_id:k.get("uid"),username:k.get("userName"),image:new v.File(u.name,u)},{onSuccess:function(e){var n;x(""),c(null),m(""),P(e),i(),null===(n=q.current)||void 0===n||n.scrollTo({top:0})}});case 7:if(!k||u){e.next=10;break}return e.next=10,C({content:f,greet_id:n,comment_by_user_id:k.get("uid"),username:k.get("userName")},{onSuccess:function(e){var n;x(""),c(null),m(""),P(e),i(),null===(n=q.current)||void 0===n||n.scrollTo({top:0})}});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=V(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(H.i,{my:"sm"}),(0,r.jsx)(d.x,{my:"lg",ml:"xs",children:(0,r.jsxs)(j.x.Autosize,{maxHeight:250,scrollbarSize:5,viewportRef:q,children:[z.map((function(e,n){return(0,r.jsx)(Q,{text:e.text,timestamp:e.timestamp,userName:e.userName,self:(null===k||void 0===k?void 0:k.get("uid"))===e.userId,userId:e.userId,image:e.image||"",commentId:e.commentId,updateCount:i,deleteCommentUpdate:E},n)})),M&&(0,r.jsx)(g.M,{children:(0,r.jsx)(w.a,{variant:"bars",color:"indigo"})}),I<t&&(0,r.jsx)(J,{onClick:U})]})}),(0,r.jsx)(O,{onComment:L,onCommentChange:function(e){return m(e.target.value)},onCommentFileChange:function(e){c(null),c(e.target.files[0]),e.target.value=""},preview:p,onPreviewRemove:function(){c(null),x("")},disabled:N})]})};function X(e,n,t,r,i,o,s){try{var a=e[o](s),u=a.value}catch(c){return void t(c)}a.done?n(u):Promise.resolve(u).then(r,i)}function Y(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function s(e){X(o,r,i,s,a,"next",e)}function a(e){X(o,r,i,s,a,"throw",e)}s(void 0)}))}}var ee="https://mumbai.polygonscan.com/address/".concat(q.i.j,"#readContract"),ne=function(e){var n=e.text,t=e.icon;return(0,r.jsx)(u.k,{sx:function(e){return{width:"100%","&:hover":{backgroundColor:"dark"===e.colorScheme?e.colors.dark[5]:e.colors.gray[0]}}},p:"md",children:(0,r.jsxs)(c.Z,{position:"center",children:[t,(0,r.jsx)(l.x,{size:"sm",children:n})]})})},te=function(e){var n=e.onChange,t=e.self;return(0,r.jsxs)(k.v,{position:"bottom-end",shadow:"md",width:200,onChange:n,withinPortal:!0,zIndex:1,children:[(0,r.jsx)(k.v.Target,{children:(0,r.jsx)(p.A,{children:(0,r.jsx)(Z.Q81,{size:"100%"})})}),(0,r.jsxs)(k.v.Dropdown,{children:[(0,r.jsx)(k.v.Label,{children:"Greet menu"}),(0,r.jsx)(k.v.Item,{icon:(0,r.jsx)(z.KP3,{size:20}),component:"a",target:"_blank",rel:"noopener noreferrer",href:ee,children:"Verify This Greet"}),t&&(0,r.jsx)(k.v.Item,{icon:(0,r.jsx)(Z.nJ9,{size:20}),color:"red",children:"Hide This Greet"})]})]})},re=function(e){var n,t,i,k,I=(0,a.rZ)(),M=(0,b.n)().width,q=(0,s.useState)(!1),H=q[0],L=q[1],U=(0,s.useState)(!1),G=U[0],F=U[1],Q=(0,s.useState)(!1),R=(Q[0],Q[1]),B=(0,s.useState)(!1),O=B[0],K=B[1],V=(0,s.useState)(0),$=V[0],J=V[1],X=(0,s.useState)(0),re=X[0],ie=X[1],oe=function(){var e=(0,T.Nr)().user,n=(0,T.Oc)("NewUser",(function(n){return n.equalTo("userAddress",null===e||void 0===e?void 0:e.get("ethAddress")).limit(1)}),[null===e||void 0===e?void 0:e.get("ethAddress")]).data;return(0,s.useMemo)((function(){return!!n[0]}),[n])}(),se=(0,T.Nr)().user,ae=(0,D.fk)(e.id),ue=(0,T.Oc)("NewUser",(function(n){return n.equalTo("userName",e.userName).limit(1)})),ce=ue.data,le=(ue.isLoading,ue.isFetching,(0,T.Oc)("NewUser",(function(e){return e.equalTo("userAddress",null===se||void 0===se?void 0:se.get("ethAddress")).limit(1)}),[ce])),de=(0,T.Oc)("NewGreet",(function(n){return n.equalTo("uid",e.id)}),[],{live:!0}),fe=(0,s.useMemo)((function(){var e,n;return(null===(e=le.data[0])||void 0===e?void 0:e.get("uid"))===(null===(n=ce[0])||void 0===n?void 0:n.get("uid"))}),[le.data,ce]),me=(0,s.useCallback)((function(){ce[0]&&de.data[0]&&se&&de.data[0].relation("likes").query().equalTo("userAddress",se.get("ethAddress")).first().then((function(e){K(!!e)}))}),[ce,de.data,se]);(0,s.useEffect)((function(){me()}),[ce,de.data,me]),(0,s.useEffect)((function(){de.data[0]&&(de.data[0].relation("likes").query().count().then((function(e){J(e)})),de.data[0].relation("view").query().count().then((function(e){ie(e)})))}),[de.data]),(0,s.useEffect)((function(){var e=function(){var e=Y(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=de.data[0],le.data[0]&&(null===n||void 0===n||n.relation("view").add(le.data[0])),e.next=4,null===n||void 0===n?void 0:n.save();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[le.data,de.data]);var he=null===(n=e.images)||void 0===n?void 0:n.map((function(e){return{original:e}})),pe=function(e){return(0,r.jsx)(u.k,{onClick:e.onClick,sx:{":hover":{color:"dark"===I.colorScheme?I.white:I.colors.dark[3]}},children:(0,r.jsxs)(c.Z,{align:"center",children:[e.icon,(0,r.jsx)(l.x,{size:"sm",children:e.count})]})})},xe=function(){var e=Y(o().mark((function e(){var n,t,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe){e.next=4;break}return(0,_.yK)("registerError"),(0,_.c0)({id:"registerError",title:"Error",message:"Register or log in to like post",autoClose:2500,disallowClose:!0,color:"red",icon:(0,r.jsx)(Z.Cw1,{size:"100%"})}),e.abrupt("return");case 4:if(K(!0),n=de.data[0],!le.data[0]||O){e.next=13;break}return null===(t=n.relation("likes"))||void 0===t||t.add(le.data[0]),e.next=11,n.save();case 11:e.next=17;break;case 13:return null===(i=n.relation("likes"))||void 0===i||i.remove(le.data[0]),e.next=17,n.save();case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){M<900?(L(!0),R(!1)):(L(!1),F(!1))}),[M]),(0,r.jsxs)(c.Z,{position:"center",children:[(0,r.jsx)(d.x,{my:"md",style:{width:M<=I.breakpoints.sm?"100%":"70%",zIndex:1},children:(0,r.jsxs)(f.Z,{p:"lg",style:{backgroundColor:"dark"===I.colorScheme?I.colors.dark[9]:I.white,border:"1px solid",borderColor:I.colors.gray[7]},radius:"md",children:[(0,r.jsxs)(c.Z,{position:"apart",children:[(0,r.jsx)(E.default,{href:{pathname:"profile",query:{id:null===(t=ce[0])||void 0===t?void 0:t.get("uid")}},passHref:!0,children:(0,r.jsxs)(c.Z,{style:{cursor:"pointer"},children:[(0,r.jsx)(m.z,{position:"top-end",size:10,color:"green",style:{zIndex:"0"},disabled:!0,children:(0,r.jsx)(h.q,{radius:"lg",color:"dark",size:40,src:null===(k=null===(i=ce[0])||void 0===i?void 0:i.get("profile_pic"))||void 0===k?void 0:k.url(),children:(0,r.jsx)(C.Mdg,{size:"100%"})})}),(0,r.jsxs)(d.x,{children:[(0,r.jsx)(l.x,{weight:500,children:e.userName}),(0,r.jsx)(l.x,{size:"sm",style:{color:I.colors.gray[6],lineHeight:1.5},children:P()(1e3*parseInt(e.timestamp)).fromNow()})]})]})}),(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(d.x,{children:(0,r.jsxs)(l.x,{size:"xs",style:{color:I.colors.gray[6],lineHeight:1.5},children:["GreetID: ",e.id]})}),H?(0,r.jsx)(p.A,{onClick:function(){F(!0)},children:(0,r.jsx)(Z.Q81,{size:"100%"})}):(0,r.jsx)(te,{onChange:R,self:fe})]})]}),(0,r.jsx)(d.x,{my:"sm",children:(0,r.jsx)(x.o,{maxHeight:120,hideLabel:"Hide",showLabel:"Show more",children:(0,r.jsx)(l.x,{size:"sm",style:{whiteSpace:"pre-line"},children:e.textContent})})}),(0,r.jsx)(f.Z.Section,{children:he&&(0,r.jsx)(A(),{items:he,showThumbnails:!1,showBullets:!!he&&he.length>1,showPlayButton:!1,showFullscreenButton:!1,showNav:M>I.breakpoints.sm,renderItem:function(e){return(0,r.jsx)(v.E,{src:e.original,alt:"",withPlaceholder:!0,placeholder:(0,r.jsx)(g.M,{children:(0,r.jsx)(w.a,{variant:"bars",color:"indigo"})})})},renderLeftNav:function(e,n){return(0,r.jsx)(u.k,{type:"button",className:"image-gallery-icon image-gallery-left-nav",disabled:n,onClick:e,"aria-label":"Previous Slide",sx:{height:"100%"},children:(0,r.jsx)(z.CF5,{size:20})})},renderRightNav:function(e,n){return(0,r.jsx)(u.k,{type:"button",className:"image-gallery-icon image-gallery-right-nav",disabled:n,onClick:e,"aria-label":"Next Slide",sx:{height:"100%"},children:(0,r.jsx)(z.Td4,{size:20})})}})}),(0,r.jsx)(d.x,{mr:"sm",children:(0,r.jsxs)(c.Z,{position:"right",mt:"lg",style:{width:"100%"},children:[(0,r.jsx)(pe,{icon:(0,r.jsx)(N.tVv,{size:20,className:"feedButton",color:O?"red":"none"}),count:$,onClick:xe}),(0,r.jsx)(pe,{icon:(0,r.jsx)(S.DCG,{size:20,className:"feedButton"}),count:ae.count}),(0,r.jsxs)(c.Z,{align:"center",children:[(0,r.jsx)(S.dSq,{size:20,className:"feedButton"}),(0,r.jsx)(l.x,{size:"sm",children:re})]})]})}),ce&&(0,r.jsx)(W,{id:e.id,count:ae.count,updateCount:ae.updateCount})]})}),(0,r.jsx)(y.d,{opened:G,onClose:function(){return F(!1)},position:"bottom",size:"lg",title:(0,r.jsx)(l.x,{p:"md",children:"Greet Menu"}),children:(0,r.jsx)(j.x,{type:"auto",style:{height:300},scrollbarSize:5,mx:"sm",children:(0,r.jsx)(c.Z,{position:"center",style:{width:"100%"},children:(0,r.jsx)("a",{href:ee,target:"_blank",rel:"noreferrer",style:{width:"100%"},children:(0,r.jsx)(ne,{text:"Verify this Greet",icon:(0,r.jsx)(z.KP3,{})})})})})})]})},ie=t(58533),oe=function(e){(0,b.n)().width;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(d.x,{children:(0,r.jsx)(ie.Z,{dataLength:e.feeds.length,next:e.fetchMore,hasMore:e.hasMore,loader:(0,r.jsx)(g.M,{children:(0,r.jsx)(w.a,{variant:"bars",color:"indigo"})}),children:e.feeds.map((function(e){return(0,r.jsx)(re,{userName:e.userName,id:e.id,timestamp:e.timestamp,textContent:e.textContent,images:e.images,video:e.video},e.id)}))})})})}},65338:function(e,n,t){t.d(n,{xe:function(){return j},fk:function(){return k},dT:function(){return y},kq:function(){return w}});var r=t(34051),i=t.n(r),o=t(40681),s=t(67294),a=t(83078),u=t(9669),c=t.n(u),l=t(68949);function d(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function f(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return d(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return d(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=new(function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.feeds=[],this.page=1,this.hasMore=!0,this.next="",(0,l.ky)(this,{},{autoBind:!0})}var n,t,r,i=e.prototype;return i.addLoadedFeed=function(e){var n;(n=this.feeds).push.apply(n,m(e))},i.clearloadedFeed=function(){this.feeds=[]},i.getPage=function(){return this.page},i.addPage=function(){this.page+=1},i.setPage=function(e){this.page=e},i.setHasMore=function(e){this.hasMore=e},i.setNext=function(e){this.next=e},n=e,(t=[{key:"getSkip",get:function(){return this.page-1}}])&&f(n.prototype,t),r&&f(n,r),e}());function p(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function x(e,n,t,r,i,o,s){try{var a=e[o](s),u=a.value}catch(c){return void t(c)}a.done?n(u):Promise.resolve(u).then(r,i)}function v(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function s(e){x(o,r,i,s,a,"next",e)}function a(e){x(o,r,i,s,a,"throw",e)}s(void 0)}))}}function g(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return p(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return p(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e){var n=(0,a.Nr)(),t=n.Moralis,r=n.isInitialized,o=(0,s.useState)(!0),u=o[0],c=o[1],l=function(){var e=v(i().mark((function e(){var n,o,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=8;break}return(o=new t.Query("NewGreet")).descending("timestamp_decimal").notEqualTo("uri","").lessThan("timestamp_decimal",parseInt(null===(n=h.feeds.at(-1))||void 0===n?void 0:n.timestamp)).limit(6),e.next=6,o.find();case 6:return s=e.sent,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=v(i().mark((function e(){var n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=7;break}return(n=new t.Query("NewGreet")).descending("timestamp_decimal").notEqualTo("uri","").limit(6),e.next=5,n.find();case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=v(i().mark((function e(){var n,t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),1===h.getPage()&&h.addPage(),e.next=4,l();case 4:if(!(n=e.sent)){e.next=9;break}n.length>5?(t=null===n||void 0===n?void 0:n.pop(),h.setNext(null===t||void 0===t?void 0:t.get("timestamp"))):h.setHasMore(!1),e.next=11;break;case 9:return h.setHasMore(!1),e.abrupt("return");case 11:return e.next=13,b(n||[]);case 13:0!==(r=e.sent).length&&h.addLoadedFeed(r),c(!1),h.addPage();case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=v(i().mark((function e(){var n,t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,d();case 3:if(!(n=e.sent)){e.next=8;break}n.length>=5?(t=null===n||void 0===n?void 0:n.pop(),h.setNext(null===t||void 0===t?void 0:t.get("timestamp"))):h.setHasMore(!1),e.next=10;break;case 8:return h.setHasMore(!1),e.abrupt("return");case 10:return e.next=12,b(n||[]);case 12:0!==(r=e.sent).length&&h.addLoadedFeed(r),c(!1);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){r&&0===h.feeds.length&&m()}),[r]),{fetchMore:f,feed:h.feeds,count:h.feeds.length,hasMore:h.hasMore,loading:u}}function y(e){var n=(0,s.useState)(1),t=n[0],r=n[1],u=(0,s.useState)(!0),c=u[0],l=u[1],d=(0,s.useState)([]),f=d[0],m=d[1],h=(0,a.Nr)(),p=h.Moralis,x=h.isInitialized,g=(0,o.s)(null===e||void 0===e?void 0:e.userId),w=g.result,y=(g.userName,g.greetCount,g.self,g.loading),j=(0,s.useCallback)((function(){return new Promise((function(n,t){x&&(null===e||void 0===e?void 0:e.userId)&&!y&&w&&n()}))}),[x,null===e||void 0===e?void 0:e.userId,y,w]),k=(0,s.useMemo)((function(){return f.filter((function(e,n,t){return t.findIndex((function(n){return n.id===e.id}))===n}))}),[f]),C=function(){var e=v(i().mark((function e(){var n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:return(n=new p.Query("NewGreet")).descending("timestamp_decimal").notEqualTo("uri","").equalTo("creator",null===w||void 0===w?void 0:w.get("userAddress")).skip(5*(t-1)).limit(5),e.next=6,n.find();case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=v(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:if(0!==(null===(n=e.sent)||void 0===n?void 0:n.length)&&n){e.next=6;break}return l(!1),e.abrupt("return");case 6:return e.next=8,b(n||[]);case 8:0!==(t=e.sent).length&&m((function(e){return e.concat(t)})),r((function(e){return e+1}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=v(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:return n=e.sent,e.next=5,b(n||[]);case 5:0!==(t=e.sent).length&&m((function(e){return e.concat(t)})),r((function(e){return e+1}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){console.log(w),w&&!y&&S()}),[y,w]),{fetchMore:N,feed:k,count:f.length,hasMore:c}}function j(e){var n=e.id,t=(0,a.Nr)(),r=t.Moralis,o=t.isInitialized,u=(0,s.useState)([]),c=u[0],l=u[1],d=(0,s.useState)(!0),f=d[0],m=d[1],h=(0,s.useState)(1),p=h[0],x=h[1],w=(0,s.useState)(!0),y=w[0],j=w[1],k=function(){var e=v(i().mark((function e(){var t,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=7;break}return(t=new r.Query("GreetComment")).equalTo("greet_id",n).descending("createdAt").skip(5*(p-1)).limit(5),e.next=5,t.find();case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=v(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,k();case 3:if(0!==(null===(n=e.sent)||void 0===n?void 0:n.length)&&n){e.next=7;break}return j(!1),e.abrupt("return");case 7:0!==(t=C(n)).length&&l((function(e){return e.concat(t)})),m(!1),x((function(e){return e+1}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=v(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,k();case 3:n=e.sent,0!==(t=C(n||[])).length&&l((function(e){return e.concat(t)})),m(!1),x((function(e){return e+1}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){o&&N()}),[o]),(0,s.useEffect)((function(){console.log(c)}),[c]),{fetchMore:b,comment:c||[],count:c.length,hasMore:y,loading:f,newCommentUpdate:function(e){var n=C([e]);l((function(e){return g(n).concat(g(e))}))},deleteCommentUpdate:function(e){l((function(n){return n.filter((function(n){return n.commentId!==e}))}))}}}function k(e){var n=(0,a.Nr)(),t=n.Moralis,r=n.isInitialized,o=(0,s.useState)(0),u=o[0],c=o[1],l=function(){var n=v(i().mark((function n(){var o,s;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r){n.next=7;break}return(o=new t.Query("GreetComment")).equalTo("greet_id",e),n.next=5,o.count();case 5:s=n.sent,c(s);case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,s.useEffect)((function(){r&&l()}),[r]),{count:u,updateCount:function(){l()}}}var b=function(){var e=v(i().mark((function e(n){var t,r,o,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return c().get(e.get("uri"))})));case 2:return t=e.sent,r=n.map((function(e){return e.get("uid")})),o=n.map((function(e){return e.get("timestamp")})),s=t.map((function(e,n){var t,i=e.data;return{userName:i.creatorName,id:r[n],images:null===(t=i.images)||void 0===t?void 0:t.map((function(e){return e.URI})),textContent:i.text,timestamp:o[n]}})),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function C(e){return e.map((function(e){var n;return{text:e.get("content"),userName:e.get("username"),userId:e.get("comment_by_user_id"),image:(null===(n=e.get("image"))||void 0===n?void 0:n.url())||"",timestamp:new Date(e.get("createdAt")).getTime().toString(),commentId:e.id}}))}},40681:function(e,n,t){t.d(n,{s:function(){return u}});var r=t(34051),i=t.n(r),o=t(67294),s=t(83078);function a(e,n,t,r,i,o,s){try{var a=e[o](s),u=a.value}catch(c){return void t(c)}a.done?n(u):Promise.resolve(u).then(r,i)}function u(e){var n,t=(0,o.useState)(""),r=t[0],u=t[1],c=(0,o.useState)(0),l=c[0],d=c[1],f=(0,o.useState)(!1),m=f[0],h=f[1],p=(0,o.useState)(!1),x=p[0],v=p[1],g=(0,s.Nr)(),w=g.Moralis,y=g.isInitialized,j=(g.isInitializing,g.user),k=(g.isAuthenticating,(0,o.useState)(void 0)),b=k[0],C=k[1],N=(0,o.useCallback)((n=i().mark((function n(){var t,r,o,s,a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!y){n.next=16;break}return v(!0),t=new w.Query("NewUser"),n.next=5,t.equalTo("uid",e).first();case 5:return r=n.sent,u(null===r||void 0===r?void 0:r.get("userName")),C(r),o=new w.Query("NewGreet"),n.next=11,o.equalTo("creator",null===r||void 0===r?void 0:r.get("userAddress")).notEqualTo("uri","").count();case 11:s=n.sent,d(s),a=(null===j||void 0===j?void 0:j.get("ethAddress"))===(null===r||void 0===r?void 0:r.get("userAddress")),h(a),v(!1);case 16:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,i){var o=n.apply(e,t);function s(e){a(o,r,i,s,u,"next",e)}function u(e){a(o,r,i,s,u,"throw",e)}s(void 0)}))}),[y,w.Query,e,j]);return(0,o.useEffect)((function(){N()}),[j,N]),{result:b,greetCount:l,self:m,userName:r,loading:x}}}}]);